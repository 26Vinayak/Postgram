(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{219:function(e,t,n){},229:function(e,t,n){"use strict";n.r(t);var a=n(83),s=n.n(a),c=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,265)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))},r=n(0),o=(n(218),n(219),n(33)),i=n(16),j=n(253),l=n(259),d=n(34),b=n(252),u=n(127),m=n(44),O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(r.useState)(t),a=Object(i.a)(n,2),s=a[0],c=a[1],o=function(e){c(Object(m.a)(Object(m.a)({},s),{},Object(u.a)({},e.target.name,e.target.value)))},j=function(t){t.preventDefault(),e()};return{onChange:o,onSubmit:j,values:s}},h=n(186),x=n(2),p={user:null};if(localStorage.getItem("jwtToken")){var g=Object(h.a)(localStorage.getItem("jwtToken"));1e3*g.exp<Date.now()?localStorage.removeItem("jwtToken"):p.user=g}var v,f=Object(r.createContext)({user:null,login:function(e){},logout:function(){}});function C(e,t){switch(t.type){case"LOGIN":return Object(m.a)(Object(m.a)({},e),{},{user:t.payload});case"LOGOUT":return Object(m.a)(Object(m.a)({},e),{},{user:null});default:return e}}function y(e){var t=Object(r.useReducer)(C,p),n=Object(i.a)(t,2),a=n[0],s=n[1];return Object(x.jsx)(f.Provider,Object(m.a)({value:{user:a.user,login:function(e){localStorage.setItem("jwtToken",e.token),s({type:"LOGIN",payload:e})},logout:function(){localStorage.removeItem("jwtToken"),s({type:"LOGOUT"})}}},e))}var I,w=Object(d.a)(v||(v=Object(o.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      id\n      email\n      username\n      createdAt\n      token\n    }\n  }\n"]))),k=function(e){var t=Object(r.useContext)(f),n=Object(r.useState)({}),a=Object(i.a)(n,2),s=a[0],c=a[1],o=O((function(){g()}),{username:"",password:""}),d=o.onChange,u=o.onSubmit,m=o.values,h=Object(b.a)(w,{update:function(n,a){var s;t.login(null===a||void 0===a||null===(s=a.data)||void 0===s?void 0:s.login),e.history.push("/")},onError:function(e){c(e.graphQLErrors[0].extensions.exception.errors)},variables:m}),p=Object(i.a)(h,2),g=p[0],v=p[1].loading;return Object(x.jsxs)("div",{className:"form-container",children:[Object(x.jsxs)(j.a,{onSubmit:u,noValidate:!0,className:v?"loading":"",children:[Object(x.jsx)("h1",{children:"Login"}),Object(x.jsx)(j.a.Input,{type:"text",label:"Username",placeholder:"Username...",name:"username",value:m.username,error:!!s.username,onChange:d}),Object(x.jsx)(j.a.Input,{label:"Password",placeholder:"Password...",name:"password",type:"password",error:!!s.password,value:m.password,onChange:d}),Object(x.jsx)(l.a,{type:"submit",primary:!0,children:"Login"})]}),Object.keys(s).length>0&&Object(x.jsx)("div",{className:"ui error message",children:Object(x.jsx)("ul",{className:"list",children:Object.values(s).map((function(e){return Object(x.jsx)("li",{children:e},e)}))})})]})};var P,S=Object(d.a)(I||(I=Object(o.a)(["\n    mutation register(\n        $username:String!\n        $email:String!\n        $password:String!\n        $confirmPassword:String!\n    ){\n        register(\n            registerInput:{\n                username:$username\n                email:$email\n                password:$password\n                confirmPassword:$confirmPassword\n            }\n        ){\n            id\n            email\n            username\n            createdAt\n            token\n        }\n    }\n"]))),L=function(e){var t=Object(r.useState)({}),n=Object(i.a)(t,2),a=n[0],s=n[1],c=Object(r.useContext)(f),o=O((function(){g()}),{username:"",email:"",password:"",confirmPassword:""}),d=o.onChange,u=o.onSubmit,m=o.values,h=Object(b.a)(S,{update:function(t,n){var a=n.data.register;console.log(a),c.login(a),e.history.push("/")},onError:function(e){s(e.graphQLErrors[0].extensions.exception.errors)},variables:m}),p=Object(i.a)(h,2),g=p[0],v=p[1].loading;return Object(x.jsxs)("div",{className:"form-container",children:[Object(x.jsxs)(j.a,{onSubmit:u,noValidate:!0,className:v?"loading":"",children:[Object(x.jsx)("h1",{children:"Register"}),Object(x.jsx)(j.a.Input,{type:"text",label:"Username",placeholder:"Username...",name:"username",value:m.username,error:!!a.username,onChange:d}),Object(x.jsx)(j.a.Input,{type:"email",label:"Email",placeholder:"Email...",name:"email",error:!!a.email,value:m.email,onChange:d}),Object(x.jsx)(j.a.Input,{label:"Password",placeholder:"Password...",name:"password",type:"password",error:!!a.password,value:m.password,onChange:d}),Object(x.jsx)(j.a.Input,{type:"password",label:"Confirm Password",placeholder:"Confirm Password...",error:!!a.confirmPassword,name:"confirmPassword",value:m.confirmPassword,onChange:d}),Object(x.jsx)(l.a,{type:"submit",primary:!0,children:"Register"})]}),Object.keys(a).length>0&&Object(x.jsx)("div",{className:"ui error message",children:Object(x.jsx)("ul",{className:"list",children:Object.values(a).map((function(e){return Object(x.jsx)("li",{children:e},e)}))})})]})},$=n(198),A=n(260),N=n(262),D=n(263),E=n(258),T=n(255),H=n(257),Q=n(196),F=n(251),R=n(43),U=n(121),q=n.n(U),z=n(113),B=n(152);var G,M,J,V=Object(d.a)(P||(P=Object(o.a)(["\n  mutation likePost($postId: ID!) {\n    likePost(postId: $postId) {\n      id\n      likes {\n        id\n        username\n      }\n      likeCount\n    }\n  }\n"]))),W=function(e){var t=e.post,n=t.id,a=t.likeCount,s=t.likes,c=e.user,o=Object(r.useState)(""),j=Object(i.a)(o,2),d=(j[0],j[1]),u=Object(r.useState)(!1),m=Object(i.a)(u,2),O=m[0],h=m[1];Object(r.useEffect)((function(){c&&s.find((function(e){return e.username===c.username}))?h(!0):h(!1)}),[c,s]);var p=Object(b.a)(V,{variables:{postId:n},onError:function(e){d(e.graphQLErrors[0].extensions.exception.errors)}}),g=Object(i.a)(p,1)[0],v=c?O?Object(x.jsx)(l.a,{color:"pink",children:Object(x.jsx)(z.a,{name:"heart"})}):Object(x.jsx)(F.a,{content:"Like on post",inverted:!0,trigger:Object(x.jsx)(l.a,{color:"pink",basic:!0,children:Object(x.jsx)(z.a,{name:"heart"})})}):Object(x.jsx)(F.a,{content:"Like on post",inverted:!0,trigger:Object(x.jsx)(l.a,{as:R.b,to:"/login",color:"pink",basic:!0,children:Object(x.jsx)(z.a,{name:"heart"})})});return Object(x.jsxs)(l.a,{as:"div",labelPosition:"right",onClick:g,children:[v,Object(x.jsx)(B.a,{as:"a",basic:!0,color:"pink",pointing:"left",children:a})]})},K=n(256);var X=Object(d.a)(G||(G=Object(o.a)(["\n    mutation deletePost($postId:ID!){\n        deletePost(postId:$postId)\n    }\n"]))),Y=Object(d.a)(M||(M=Object(o.a)(["\n    mutation deleteComment($postId:ID! , $commentId:ID!)\n    {\n        deleteComment(postId:$postId , commentId:$commentId){\n            id\n            comments{\n                id\n                username\n                createdAt\n                body\n            }\n            commentCount\n        }\n    }\n"]))),Z=Object(d.a)(J||(J=Object(o.a)(["\n    {\n        getPosts{ \n            id \n            body \n            createdAt \n            username \n            likeCount\n            likes{\n                username \n            }\n            commentCount\n            comments{\n                id \n                username \n                createdAt \n                body\n            }\n        }\n    }\n"]))),_=function(e){var t=e.postId,n=e.callback,a=e.commentId,s=Object(r.useState)(!1),c=Object(i.a)(s,2),o=c[0],j=c[1],d=a?Y:X,u=Object(b.a)(d,{update:function(e){if(j(!1),!a){var s=e.readQuery({query:Z});s.getPosts=s.getPosts.filter((function(e){return e.id!==t})),e.writeQuery({query:Z,data:s})}n&&n()},variables:{postId:t,commentId:a}}),m=Object(i.a)(u,1)[0];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(F.a,{content:a?"Delete comment":"Delete post",inverted:!0,trigger:Object(x.jsx)(l.a,{as:"div",color:"red",floated:"right",onClick:function(){return j(!0)},children:Object(x.jsx)(z.a,{name:"trash",style:{margin:0}})})}),Object(x.jsx)(K.a,{open:o,onCancel:function(){return j(!1)},onConfirm:m})]})};var ee,te,ne=function(e){var t=e.post,n=t.body,a=t.createdAt,s=t.id,c=t.username,o=t.likeCount,i=t.likes,j=t.commentCount,d=Object(r.useContext)(f).user;return Object(x.jsxs)(H.a,{fluid:!0,children:[Object(x.jsxs)(H.a.Content,{children:[Object(x.jsx)(Q.a,{floated:"right",size:"mini",src:"https://react.semantic-ui.com/images/avatar/large/molly.png"}),Object(x.jsx)(H.a.Header,{children:c}),Object(x.jsx)(H.a.Meta,{as:R.b,to:"/posts/".concat(s),children:q()(a).fromNow(!0)}),Object(x.jsx)(H.a.Description,{children:n})]}),Object(x.jsxs)(H.a.Content,{extra:!0,children:[Object(x.jsx)(W,{user:d,post:{id:s,likes:i,likeCount:o}}),Object(x.jsx)(F.a,{content:"Comment on Post",inverted:!0,trigger:Object(x.jsxs)(l.a,{labelPosition:"right",as:R.b,to:"/posts/".concat(s),children:[Object(x.jsx)(l.a,{color:"teal",basic:!0,children:Object(x.jsx)(z.a,{name:"comments"})}),Object(x.jsx)(B.a,{as:"a",basic:!0,color:"blue",pointing:"left",children:j})]})}),d&&c&&(null===d||void 0===d?void 0:d.username)===c&&Object(x.jsx)(_,{postId:s})]})]})};var ae=Object(d.a)(ee||(ee=Object(o.a)(["\n    {\n        getPosts{ \n            id \n            body \n            createdAt \n            username \n            likeCount\n            likes{\n                username \n            }\n            commentCount\n            comments{\n                id \n                username \n                createdAt \n                body\n            }\n        }\n    }\n"]))),se=Object(d.a)(te||(te=Object(o.a)(["\n    mutation createPost($body:String!){\n        createPost(body:$body){\n            id\n            body\n            createdAt\n            username\n            likes{\n                id\n                username\n                createdAt\n            }\n            likeCount\n            comments{\n                id\n                body\n                username\n                createdAt\n            }\n            commentCount\n        }\n    }\n"]))),ce=function(){var e,t=Object(r.useContext)(f).user,n=Object(A.a)(ae),a=n.loading,s=n.data,c=null===s||void 0===s?void 0:s.getPosts,o=O((function(){g()}),{body:""}),d=o.values,u=o.onChange,m=o.onSubmit,h=Object(b.a)(se,{variables:d,update:function(e,t){var n=e.readQuery({query:ae});n.getPosts=[t.data.createPost].concat(Object($.a)(n.getPosts)),e.writeQuery({query:ae,data:n}),c=null===n||void 0===n?void 0:n.getPosts,d.body=""}}),p=Object(i.a)(h,2),g=p[0],v=p[1].error;return Object(x.jsxs)(N.a,{columns:3,children:[Object(x.jsx)(N.a.Row,{className:"page-title",children:Object(x.jsx)("h1",{children:"Recent Posts"})}),Object(x.jsxs)(N.a.Row,{children:[t&&Object(x.jsxs)(N.a.Column,{children:[Object(x.jsxs)(j.a,{onSubmit:m,children:[Object(x.jsx)("h2",{children:"Create a post:"}),Object(x.jsxs)(j.a.Field,{children:[Object(x.jsx)(j.a.Input,{placeholder:"Hi World!",name:"body",onChange:u,value:d.body,error:!!v}),d.body.length>0&&Object(x.jsx)(l.a,{type:"submit",color:"teal",children:"Submit"})]})]}),v&&Object(x.jsx)("div",{className:"ui error message",style:{marginBottom:20},children:Object(x.jsx)("ul",{className:"list",children:Object(x.jsx)("li",{children:v.graphQLErrors[0].message})})})]}),a?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(N.a.Column,{children:Object(x.jsx)(D.a,{raised:!0,children:Object(x.jsxs)(E.a,{children:[Object(x.jsxs)(E.a.Header,{image:!0,children:[Object(x.jsx)(E.a.Line,{}),Object(x.jsx)(E.a.Line,{})]}),Object(x.jsxs)(E.a.Paragraph,{children:[Object(x.jsx)(E.a.Line,{length:"medium"}),Object(x.jsx)(E.a.Line,{length:"short"})]})]})})}),Object(x.jsx)(N.a.Column,{children:Object(x.jsx)(D.a,{raised:!0,children:Object(x.jsxs)(E.a,{children:[Object(x.jsxs)(E.a.Header,{image:!0,children:[Object(x.jsx)(E.a.Line,{}),Object(x.jsx)(E.a.Line,{})]}),Object(x.jsxs)(E.a.Paragraph,{children:[Object(x.jsx)(E.a.Line,{length:"medium"}),Object(x.jsx)(E.a.Line,{length:"short"})]})]})})}),Object(x.jsx)(N.a.Column,{children:Object(x.jsx)(D.a,{raised:!0,children:Object(x.jsxs)(E.a,{children:[Object(x.jsxs)(E.a.Header,{image:!0,children:[Object(x.jsx)(E.a.Line,{}),Object(x.jsx)(E.a.Line,{})]}),Object(x.jsxs)(E.a.Paragraph,{children:[Object(x.jsx)(E.a.Line,{length:"medium"}),Object(x.jsx)(E.a.Line,{length:"short"})]})]})})})]}):Object(x.jsx)(T.a.Group,{children:c&&(null===(e=c)||void 0===e?void 0:e.map((function(e){return Object(x.jsx)(N.a.Column,{style:{marginBottom:20},children:Object(x.jsx)(ne,{post:e})},e.id)})))})]})]})},re=n(18),oe=n(249),ie=n(254);var je,le,de=function(){var e=Object(r.useContext)(f),t=e.user,n=e.logout,a=window.location.pathname,s="/"===a?"home":a.substr(1),c=Object(r.useState)(s),o=Object(i.a)(c,2),j=o[0],l=o[1],d=function(e,t){var n=t.name;l(n)};return t?Object(x.jsxs)(ie.a,{pointing:!0,secondary:!0,size:"massive",color:"pink",children:[Object(x.jsx)(ie.a.Item,{name:t.username,active:!0,as:R.b,to:"/"}),Object(x.jsx)(ie.a.Menu,{position:"right",children:Object(x.jsx)(ie.a.Item,{name:"logout",onClick:n})})]}):Object(x.jsxs)(ie.a,{pointing:!0,secondary:!0,size:"massive",color:"blue",children:[Object(x.jsx)(ie.a.Item,{name:"home",active:"home"===j,onClick:d,as:R.b,to:"/"}),Object(x.jsxs)(ie.a.Menu,{position:"right",children:[Object(x.jsx)(ie.a.Item,{name:"login",active:"login"===j,onClick:d,as:R.b,to:"/login"}),Object(x.jsx)(ie.a.Item,{name:"register",active:"register"===j,onClick:d,as:R.b,to:"/register"})]})]})},be=n(201),ue=function(e){var t=e.component,n=Object(be.a)(e,["component"]),a=Object(r.useContext)(f).user;return Object(x.jsx)(re.b,Object(m.a)(Object(m.a)({},n),{},{render:function(e){return a?Object(x.jsx)(re.a,{to:"/"}):Object(x.jsx)(t,Object(m.a)({},e))}}))};var me=Object(d.a)(je||(je=Object(o.a)(["\n    mutation($postId:ID!,$body:String!){\n        createComment(postId:$postId,body:$body){\n            id\n            comments{\n                id\n                body\n                createdAt\n                username\n            }\n            commentCount\n        }\n    }\n\n"]))),Oe=Object(d.a)(le||(le=Object(o.a)(["\n    query($postId:ID!){\n        getPost(postId:$postId){\n            id\n            body\n            createdAt\n            username\n            likeCount\n            likes{\n                username\n            }\n            commentCount\n            comments{\n                id\n                username\n                createdAt\n                body\n            }\n        }\n    }\n"]))),he=function(e){var t,n=Object(r.useContext)(f).user,a=e.match.params.postId,s=Object(A.a)(Oe,{variables:{postId:a}}).data,c=Object(r.useState)(""),o=Object(i.a)(c,2),d=o[0],u=o[1],m=Object(b.a)(me,{update:function(){u("")},variables:{postId:a,body:d}}),O=Object(i.a)(m,1)[0],h=null===s||void 0===s?void 0:s.getPost;if(h){var p=h.id,g=h.body,v=h.createdAt,C=h.username,y=h.comments,I=h.likes,w=h.likeCount,k=h.commentCount;t=Object(x.jsx)(N.a,{children:Object(x.jsxs)(N.a.Row,{children:[Object(x.jsx)(N.a.Column,{width:2,children:Object(x.jsx)(Q.a,{src:"https://react.semantic-ui.com/images/avatar/large/molly.png",size:"small",float:"right"})}),Object(x.jsxs)(N.a.Column,{width:10,children:[Object(x.jsxs)(H.a,{fluid:!0,children:[Object(x.jsxs)(H.a.Content,{children:[Object(x.jsx)(H.a.Header,{children:C}),Object(x.jsx)(H.a.Meta,{children:q()(v).fromNow()}),Object(x.jsx)(H.a.Description,{children:g})]}),Object(x.jsx)("hr",{}),Object(x.jsxs)(H.a.Content,{extra:!0,children:[Object(x.jsx)(W,{user:n,post:{id:p,likes:I,likeCount:w}}),Object(x.jsx)(F.a,{content:"Comment on post",inverted:!0,trigger:Object(x.jsxs)(l.a,{as:"div",labelPosition:"right",onClick:function(){return console.log("comment on post")},children:[Object(x.jsx)(l.a,{basic:!0,color:"teal",children:Object(x.jsx)(z.a,{name:"comments"})}),Object(x.jsx)(B.a,{basic:!0,color:"blue",pointing:"left",children:k})]})}),n&&C&&(null===n||void 0===n?void 0:n.username)===C&&Object(x.jsx)(_,{postId:p,callback:function(){e.history.push("/")}})]})]}),n&&Object(x.jsx)(H.a,{fluid:!0,children:Object(x.jsxs)(H.a.Content,{children:[Object(x.jsx)("p",{children:"Post a comment..."}),Object(x.jsx)(j.a,{children:Object(x.jsxs)("div",{class:"ui action input fluid",children:[Object(x.jsx)("input",{type:"text",placeholder:"Comment..",name:"comment",value:d,onChange:function(e){return u(e.target.value)}}),Object(x.jsx)("button",{type:"submit",className:"ui button teal",disabled:""===d.trim(),onClick:O,children:Object(x.jsx)("strong",{style:{color:"white"},children:"Submit"})})]})})]})}),y.map((function(e){return Object(x.jsx)(H.a,{fluid:!0,children:Object(x.jsxs)(H.a.Content,{children:[n&&n.username===e.username&&Object(x.jsx)(_,{postId:p,commentId:e.id}),Object(x.jsx)(H.a.Header,{children:e.username}),Object(x.jsx)(H.a.Meta,{children:q()(e.createdAt).fromNow()}),Object(x.jsx)(H.a.Description,{children:e.body})]})})}))]})]})})}else t=Object(x.jsx)(N.a.Column,{children:Object(x.jsx)(D.a,{raised:!0,children:Object(x.jsxs)(E.a,{children:[Object(x.jsxs)(E.a.Header,{image:!0,children:[Object(x.jsx)(E.a.Line,{}),Object(x.jsx)(E.a.Line,{})]}),Object(x.jsxs)(E.a.Paragraph,{children:[Object(x.jsx)(E.a.Line,{length:"medium"}),Object(x.jsx)(E.a.Line,{length:"short"})]})]})})});return t};var xe=function(){return Object(x.jsx)(y,{children:Object(x.jsx)(R.a,{children:Object(x.jsxs)(oe.a,{children:[Object(x.jsx)(de,{}),Object(x.jsx)(re.b,{exact:!0,path:"/",component:ce}),Object(x.jsx)(ue,{exact:!0,path:"/login",component:k}),Object(x.jsx)(ue,{exact:!0,path:"/register",component:L}),Object(x.jsx)(re.b,{exact:!0,path:"/posts/:postId",component:he})]})})})},pe=n(193),ge=n(197),ve=n(199),fe=n(250),Ce=n(200),ye=Object(ve.a)({uri:"https://postgarm-26.herokuapp.com/"}),Ie=Object(Ce.a)((function(){var e=localStorage.getItem("jwtToken");return console.log(e),{headers:{Authorization:e?"Bearer ".concat(e):""}}})),we=new pe.a({link:Ie.concat(ye),cache:new ge.a}),ke=Object(x.jsx)(fe.a,{client:we,children:Object(x.jsx)(xe,{})});s.a.render(ke,document.getElementById("root")),c()}},[[229,1,2]]]);
//# sourceMappingURL=main.a4b593b1.chunk.js.map